{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Exploration Context Schema",
  "description": "Code exploration results from cli-explore-agent for task context gathering",
  "type": "object",
  "required": [
    "project_structure",
    "relevant_files",
    "patterns",
    "dependencies",
    "integration_points",
    "constraints",
    "clarification_needs",
    "_metadata"
  ],
  "properties": {
    "project_structure": {
      "type": "string",
      "description": "Overall architecture description: module organization, layer structure, component relationships"
    },
    "relevant_files": {
      "type": "array",
      "items": {"type": "string"},
      "description": "File paths to be modified or referenced for the task"
    },
    "patterns": {
      "type": "string",
      "description": "Existing code patterns, conventions, and styles found in the codebase"
    },
    "dependencies": {
      "type": "string",
      "description": "External and internal module dependencies relevant to the task"
    },
    "integration_points": {
      "type": "string",
      "description": "Where this task connects with existing code: APIs, hooks, events, shared state"
    },
    "constraints": {
      "type": "string",
      "description": "Technical constraints and limitations affecting implementation"
    },
    "clarification_needs": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["question", "context", "options"],
        "properties": {
          "question": {
            "type": "string",
            "description": "The clarification question to ask user"
          },
          "context": {
            "type": "string",
            "description": "Background context explaining why this clarification is needed"
          },
          "options": {
            "type": "array",
            "items": {"type": "string"},
            "description": "Available options for user to choose from (2-4 options)"
          }
        }
      },
      "description": "Ambiguities requiring user input before planning"
    },
    "_metadata": {
      "type": "object",
      "required": ["timestamp", "task_description", "source"],
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of exploration"
        },
        "task_description": {
          "type": "string",
          "description": "Original task description that triggered exploration"
        },
        "source": {
          "type": "string",
          "const": "cli-explore-agent",
          "description": "Agent that performed exploration"
        },
        "duration_seconds": {
          "type": "integer",
          "description": "Exploration duration in seconds"
        }
      }
    }
  }
}
