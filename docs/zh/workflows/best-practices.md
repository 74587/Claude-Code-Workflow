# 工作流最佳实践

优化您的 CCW 工作流以获得最高效率和质量。

## 规格说明阶段

### 应该做的

- **从明确的目标开始**: 提前定义成功标准
- **让利益相关者参与**: 从所有利益相关者收集需求
- **记录假设**: 将隐性知识显式化
- **及早识别风险**: 评估技术和项目风险

### 不应该做的

- 跳过研究阶段
- 未经验证就假设需求
- 忽略技术约束
- 过度设计解决方案

## 规划阶段

### 应该做的

- **分解任务**: 细粒度的任务更容易估算
- **映射依赖**: 及早识别任务关系
- **现实估算**: 使用历史数据进行估算
- **规划迭代**: 为未知因素预留缓冲

### 不应该做的

- 创建单体任务
- 忽略任务依赖
- 低估复杂度
- 提前规划所有内容

## 实现阶段

### 应该做的

- **遵循计划**: 相信规划过程
- **边写边测**: 与代码同步编写测试
- **记录变更**: 保持文档同步
- **频繁验证**: 每次变更后运行测试

### 不应该做的

- 未经讨论偏离计划
- 为了速度跳过测试
- 推迟文档编写
- 忽略反馈

## 验证阶段

### 应该做的

- **全面测试**: 覆盖正常路径和边界情况
- **审查代码**: 使用代码审查指南
- **衡量质量**: 使用自动化指标
- **记录发现**: 创建测试报告

### 不应该做的

- 跳过边界情况测试
- 忽略审查反馈
- 仅依赖手动测试
- 隐藏测试失败

## 团队协调

### 沟通

- **使用 SendMessage**: 始终通过协调器沟通
- **具体明确**: 清晰的消息减少来回沟通
- **报告进度**: 定期更新状态
- **上报阻塞**: 不要等待阻塞问题

### 协作

- **尊重边界**: 每个角色有特定职责
- **信任流程**: 工作流确保质量
- **分享知识**: 贡献智慧文件
- **从失败中学习**: 事后分析改进未来工作流

## 常见陷阱

### 规格说明

| 陷阱 | 影响 | 预防措施 |
|------|------|----------|
| 模糊的需求 | 返工 | 使用验收标准 |
| 缺少约束 | 实现失败 | 明确列出非功能性需求 |
| 范围不清 | 范围蔓延 | 定义范围内/范围外 |

### 规划

| 陷阱 | 影响 | 预防措施 |
|------|------|----------|
| 乐观估算 | 延误 | 使用不确定性锥 |
| 未知依赖 | 任务阻塞 | 先探索代码库 |
| 单线程规划 | 瓶颈 | 识别并行机会 |

### 实现

| 陷阱 | 影响 | 预防措施 |
|------|------|----------|
| 跳过测试 | 生产环境 Bug | 测试优先方法 |
| 忽略反馈 | PR 被拒绝 | 处理审查意见 |
| 镀金 | 交付延迟 | 遵循需求 |

## 工作流优化

### 减少周期时间

1. **批量处理相似任务**: 减少上下文切换
2. **自动化验证**: 持续集成
3. **并行执行**: 识别独立任务
4. **快速推进**: 对简单继任跳过协调器

### 提高质量

1. **早期验证**: 测试优先开发
2. **同行审查**: 多审查者视角
3. **自动化测试**: 全面的测试覆盖
4. **指标跟踪**: 衡量质量指标

### 有效扩展

1. **史诗分解**: 大项目 → 史诗 → 任务
2. **团队专业化**: 基于角色的智能体分配
3. **知识共享**: 智慧积累
4. **流程改进**: 持续改进

## 示例

### 良好的工作流

```
[Specification]
  ↓ Clear requirements with acceptance criteria
[Planning]
  ↓ Realistic estimates with identified dependencies
[Implementation]
  ↓ Tests pass, documentation updated
[Validation]
  ↓ All acceptance criteria met
[Complete]
```

### 有问题的工作流

```
[Specification]
  ↓ Vague requirements, no acceptance criteria
[Planning]
  ↓ Optimistic estimates, missed dependencies
[Implementation]
  ↓ No tests, incomplete documentation
[Validation]
  ↓ Failed tests, missing requirements
[Rework]
```

::: info 另见
- [四级系统](./4-level.md) - 详细工作流说明
- [智能体](../agents/) - 智能体能力
:::
